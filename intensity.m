i=sqrt(-1);
k1V=192000;k1H=192000;
In=[];aR=[];
Fcc=[0;...
    0;...
    0;...
    k1V;...
    k1V;...
    k1H;...
    k1H;...
    0;...
    0];
for k=1:10
for j=1:60
    av=-0.3+j/100;
    aR(j)=av;
    w=2*pi*5*k; 
   M=[m2 0 0 0 0 0 0 0 0;...
    0 J2x 0 0 0 0 0 0 0;...
    0 0 J2y 0 0 0 0 0 0;...
    0 0 0 m1V 0 0 0 0 0;...
    0 0 0 0 m1V 0 0 0 0;...
    0 0 0 0 0 m1H 0 0 0;...
    0 0 0 0 0 0 m1H 0 0;...
    0 0 0 0 0 0 0 m3 0;...
    0 0 0 0 0 0 0 0 m3];  
K=[2*(k2V+k2H+k3) k3*(ls+av) 2*(k2H*l2H-k2V*l2V)+k3*(l3H-l3V) -k2V -k2V -k2H -k2H -k3 -k3;...
    k3*(ls+av) 0.5*(k2V+k2H)*s^2+k3*(ls^2+av^2) k3*(av*l3H-ls*l3V) -0.5*k2V*s 0.5*k2V*s -0.5*k2H*s 0.5*k2H*s -k3*ls -k3*av;...
    2*(k2H*l2H-k2V*l2V)+k3*(l3H-l3V) k3*(av*l3H-ls*l3V) 2*(k2V*l2V^2+k2H*l2H^2)+k3*(l3V^2+l3H^2) k2V*l2V k2V*l2V -k2H*l2H -k2H*l2H k3*l3V -k3*l3H;...
    -k2V -0.5*k2V*s k2V*l2V k1V+k2V 0 0 0 0 0;...
    -k2V 0.5*k2V*s k2V*l2V 0 k1V+k2V 0 0 0 0;...
    -k2H -0.5*k2H*s -k2H*l2H 0 0 k1H+k2H 0 0 0;...
    -k2H 0.5*k2H*s -k2H*l2H 0 0 0 k1H+k2H 0 0;...
    -k3 -k3*ls k3*l3V 0 0 0 0 k3 0;...
    -k3 -k3*av -k3*l3H 0 0 0 0 0 k3];
C=[2*(c2V+c2H+c3) c3*(ls+av) 2*(c2H*l2H-c2V*l2V)+c3*(l3H-l3V) -c2V -c2V -c2H -c2H -c3 -c3;...
    c3*(ls+av) 0.5*(c2V+c2H)*s^2+c3*(ls^2+av^2) c3*(av*l3H-ls*l3V) -0.5*c2V*s 0.5*c2V*s -0.5*c2H*s 0.5*c2H*s -c3*ls -c3*av;...
    2*(c2H*l2H-c2V*l2V)+c3*(l3H-l3V) c3*(av*l3H-ls*l3V) 2*(c2V*l2V^2+c2H*l2H^2)+c3*(l3V^2+l3H^2) c2V*l2V c2V*l2V -c2H*l2H -c2H*l2H c3*l3V -c3*l3H;...
    -c2V -0.5*c2V*s c2V*l2V c2V 0 0 0 0 0;...
    -c2V 0.5*c2V*s c2V*l2V 0 c2V 0 0 0 0;...
    -c2H -0.5*c2H*s -c2H*l2H 0 0 c2H 0 0 0;...
    -c2H 0.5*c2H*s -c2H*l2H 0 0 0 c2H 0 0;...
    -c3 -c3*ls c3*l3V 0 0 0 0 c3 0;...
    -c3 -c3*av -c3*l3H 0 0 0 0 0 c3];
    Hw=inv(-w^2*M+i*w*C+K)*Fcc;
    Xai=-w^2*Hw;
    In(j,k)=(abs(Xai(8,1))*0.4+abs(Xai(9,1))*0.6)/9.8;
end
end
figure(1)
plot(aR,In(:,1),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=5Hz)');
figure(2)
plot(aR,In(:,2),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=10Hz)');
figure(3)
plot(aR,In(:,3),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=15Hz)');
figure(4)
plot(aR,In(:,4),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=20Hz)');
figure(5)
plot(aR,In(:,5),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=25Hz)');
figure(6)
plot(aR,In(:,6),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=30Hz)');
figure(7)
plot(aR,In(:,7),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=35Hz)');
figure(8)
plot(aR,In(:,8),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=40Hz)');
figure(9)
plot(aR,In(:,9),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=45Hz)');
figure(10)
plot(aR,In(:,10),'linewidth',2);grid on;
xlabel('m');ylabel('振动强度');title('振动效果(f=50Hz)');